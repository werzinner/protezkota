<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Protez Kota Listesi</title>
<style>
body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:15px;background:#f5f5f5}
.card{
  border:1px solid #ddd;
  border-radius:10px;
  padding:10px;
  margin-bottom:12px;
  background:#fff;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  transition: box-shadow 0.2s ease;
  display:flex;
  flex-direction:column;
  flex-wrap:nowrap;
}
.card:hover{
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}
.name{font-weight:600;margin-bottom:6px;font-size:16px;color:#333;min-width:150px}
.options{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:6px}
.opt{display:flex;align-items:center;gap:5px}
input[type="checkbox"]{width:18px;height:18px}
textarea{
  width:100%;
  padding:6px 8px;
  font-size:13px;
  border:1px solid #ccc;
  border-radius:6px;
  resize:vertical;
  min-height:35px;
  max-height:80px;
  flex:1 1 auto;
  min-width:120px;
  max-width:300px;
  transition: all 0.2s ease;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
}
textarea:focus{
  border-color:#007bff;
  box-shadow: 0 0 5px rgba(0,123,255,0.3);
  outline:none;
}
button{padding:10px 18px;font-size:15px;border:none;border-radius:5px;background:#007bff;color:white;cursor:pointer;margin:4px;transition:all 0.2s ease;}
button:hover{background:#0056b3}
#buttons{margin-bottom:12px; display:flex; flex-wrap:wrap; gap:5px;}
#rapor{border:1px solid #ddd;background:#fff;padding:10px;margin-top:15px;overflow-x:auto;display:none}
#rapor table{width:100%;border-collapse:collapse;margin-bottom:12px}
#rapor th,#rapor td{border:1px solid #ccc;padding:8px;text-align:left;font-size:14px}
#rapor th{background:#f5f5f5}
#showBtn{position:fixed;bottom:15px;right:15px;display:none;z-index:999;}
#raporButtons{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:10px}
.eksikKutu, .tamamKutu{border:1px solid #007bff;padding:8px;border-radius:5px;background:#e6f0ff;flex:1;min-width:130px;cursor:pointer;text-align:center;transition:all 0.2s ease}
.eksikKutu:hover, .tamamKutu:hover{background:#d0e4ff}
@media(max-width:600px){#buttons{flex-direction:column;} .options{flex-direction:column} #raporButtons{flex-direction:column}}
</style>
</head>
<body>

<h2>Protez Kota Listesi</h2>

<div id="buttons">
  <button id="eksikBtn">Eksikler Tablosu</button>
  <button id="tamamBtn">Tamamlananlar Tablosu</button>
  <button id="hepsiBtn">Tüm Tablolar</button>
  <button id="copyBtn">Tabloyu Kopyala</button>
  <button id="printBtn">Tabloyu Yazdır</button>
  <button id="toggleView">Masaüstü Modu</button>
  <button id="hideButtonsBtn">Tuşları Gizle</button>
</div>

<button id="showBtn">Tuşları Göster</button>

<div id="rapor">
  <div id="raporButtons"></div>
  <div id="raporTables"></div>
</div>
<div id="list"></div>

<script>
const names = [
  "CENNET YILDIZ","NİDA NUR SOLAK","SIMGE DÜZEN","AHMET KALAYCI",
  "PELIN BALKESEN","MUHAMMED EREN AKTAŞ","ECE KELEŞ","MEHMET BARAN BIRLIK",
  "SÜMEYRA KAVAS","FATMA ZEHRA YAŞAR","ABDULLAH YÜZER","NISA KAYA",
  "MÜMÜNE ÖZCAN","DUYGUNUR ERDOĞDU","EFE OKYAR","ÇİĞDEM SAKINCI",
  "BERKANT GİLİK","BERRAK ALTUNTAŞ","ATAKAN KAYA","SUEDA ŞAHİN",
  "ALEYNA SİDRET DEMİR","EREN SELİMLER"
];
const options = ["Sabit 1","Sabit 2","Hareketli 1","Hareketli 2"];
const container = document.getElementById("list");
const raporDiv = document.getElementById("rapor");
const raporTablesDiv = document.getElementById("raporTables");
const raporButtonsDiv = document.getElementById("raporButtons");
const showBtn = document.getElementById("showBtn");
const savedData = JSON.parse(localStorage.getItem("data") || "{}");

// Kartları oluştur
names.forEach((name,i)=>{
  const card=document.createElement("div");
  card.className="card";

  const title=document.createElement("div");
  title.className="name";
  title.textContent=name;
  card.appendChild(title);

  const optContainer=document.createElement("div");
  optContainer.className="options";
  options.forEach((opt,j)=>{
    const lbl=document.createElement("label");
    lbl.className="opt";
    const cb=document.createElement("input");
    cb.type="checkbox";
    const key = `${i}_${j}`;
    cb.checked = savedData[key] || false;
    cb.addEventListener("change",()=> {
      savedData[key] = cb.checked;
      localStorage.setItem("data",JSON.stringify(savedData));
    });
    lbl.appendChild(cb);
    lbl.appendChild(document.createTextNode(opt));
    optContainer.appendChild(lbl);
  });
  card.appendChild(optContainer);

  const ta=document.createElement("textarea");
  ta.placeholder="Not ekle...";
  const noteKey = `note_${i}`;
  ta.value = savedData[noteKey] || "";
  ta.addEventListener("input",()=>{
    savedData[noteKey] = ta.value;
    localStorage.setItem("data",JSON.stringify(savedData));
  });
  card.appendChild(ta);

  container.appendChild(card);
});

// Tablo üretme fonksiyonu
function generateTable(type){
  let html = `<table><tr><th>İsim</th><th>${type}</th></tr>`;
  names.forEach((name,i)=>{
    let items = [];
    if(type==="Sabit Eksikler"){[0,1].forEach(j=>{if(!savedData[`${i}_${j}`]) items.push(options[j])})}
    else if(type==="Hareketli Eksikler"){[2,3].forEach(j=>{if(!savedData[`${i}_${j}`]) items.push(options[j])})}
    else if(type==="Toplam Eksikler"){[0,1,2,3].forEach(j=>{if(!savedData[`${i}_${j}`]) items.push(options[j])})}
    else if(type==="Sabit Tamamlananlar"){[0,1].forEach(j=>{if(savedData[`${i}_${j}`]) items.push(options[j])})}
    else if(type==="Hareketli Tamamlananlar"){[2,3].forEach(j=>{if(savedData[`${i}_${j}`]) items.push(options[j])})}
    else if(type==="Toplam Tamamlananlar"){[0,1,2,3].forEach(j=>{if(savedData[`${i}_${j}`]) items.push(options[j])})}
    html += `<tr><td>${name}</td><td>${items.join(", ")}</td></tr>`;
  });
  html += "</table>";
  return html;
}

// Dinamik kutucuk event delegation
raporButtonsDiv.addEventListener("click",function(e){
  const el = e.target;
  if(el.classList.contains("eksikKutu")) toggleEksikKutu(el.dataset.type);
  if(el.classList.contains("tamamKutu")) toggleTamamKutu(el.dataset.type);
});

// Toggle fonksiyonları
function toggleEksikKutu(type){
  const existing = document.getElementById('table_'+type.replace(/\s/g,''));
  if(existing){ existing.remove(); return; }
  const tbl = document.createElement('div'); tbl.id = 'table_'+type.replace(/\s/g,''); tbl.innerHTML = generateTable(type);
  raporTablesDiv.appendChild(tbl);
  raporDiv.style.display='block';
}
function toggleTamamKutu(type){
  const existing = document.getElementById('table_'+type.replace(/\s/g,''));
  if(existing){ existing.remove(); return; }
  const tbl = document.createElement('div'); tbl.id = 'table_'+type.replace(/\s/g,''); tbl.innerHTML = generateTable(type);
  raporTablesDiv.appendChild(tbl);
  raporDiv.style.display='block';
}

let raporVisible=false;

// Eksikler butonu
document.getElementById("eksikBtn").addEventListener("click",()=>{
  if(raporVisible && raporDiv.dataset.type === "eksik"){raporDiv.style.display="none";raporVisible=false; return;}
  raporTablesDiv.innerHTML = "";
  raporButtonsDiv.innerHTML = `
      <div class="eksikKutu" data-type="Sabit Eksikler">Sabit Eksikler</div>
      <div class="eksikKutu" data-type="Hareketli Eksikler">Hareketli Eksikler</div>
      <div class="eksikKutu" data-type="Toplam Eksikler">Toplam Eksikler</div>`;
  raporDiv.style.display="block";
  raporDiv.dataset.type="eksik";
  raporVisible=true;
});

// Tamamlananlar butonu
document.getElementById("tamamBtn").addEventListener("click",()=>{
  if(raporVisible && raporDiv.dataset.type === "tamam"){raporDiv.style.display="none";raporVisible=false; return;}
  raporTablesDiv.innerHTML = "";
  raporButtonsDiv.innerHTML = `
      <div class="tamamKutu" data-type="Sabit Tamamlananlar">Sabit Tamamlananlar</div>
      <div class="tamamKutu" data-type="Hareketli Tamamlananlar">Hareketli Tamamlananlar</div>
      <div class="tamamKutu" data-type="Toplam Tamamlananlar">Toplam Tamamlananlar</div>`;
  raporDiv.style.display="block";
  raporDiv.dataset.type="tamam";
  raporVisible=true;
});

// Tüm tablolar toggle
document.getElementById("hepsiBtn").addEventListener("click",()=>{
  if(raporVisible && raporDiv.dataset.type === "hepsi"){ 
      raporDiv.style.display="none"; 
      raporVisible=false; 
      return;
  }
  raporTablesDiv.innerHTML = generateTable("Toplam Eksikler") + generateTable("Toplam Tamamlananlar");
  raporButtonsDiv.innerHTML = "";
  raporDiv.style.display="block";
  raporDiv.dataset.type="hepsi";
  raporVisible=true;
});

// Kopyala sadece tablo
document.getElementById("copyBtn").addEventListener("click",()=>{
  if(!raporVisible) return alert("Önce bir tablo açın!");
  const range = document.createRange();
  range.selectNode(raporTablesDiv);
  const sel = window.getSelection();
  sel.removeAllRanges();
  sel.addRange(range);
  document.execCommand('copy');
  sel.removeAllRanges();
  alert("Tablo kopyalandı ✅");
});

// Yazdır
document.getElementById("printBtn").addEventListener("click",()=>{
  if(!raporVisible) return alert("Önce bir tablo açın!");
  const printWindow = window.open('', '', 'height=600,width=800');
  printWindow.document.write('<html><head><title>Tablo Yazdır</title></head><body>');
  printWindow.document.write(raporTablesDiv.innerHTML);
  printWindow.document.write('</body></html>');
  printWindow.document.close();
  printWindow.print();
});

// Masaüstü modu
let desktopMode=false;
document.getElementById("toggleView").addEventListener("click",()=>{
  desktopMode=!desktopMode;
  document.querySelectorAll(".card").forEach(card=>{
    if(desktopMode){
      card.style.display="flex";
      card.style.alignItems="center";
      card.style.flexWrap="wrap"; 
      card.querySelector(".options").style.flexDirection="row";
      card.querySelector("textarea").style.width="200px";
    }else{
      card.style.display="block";
      card.querySelector(".options").style.flexDirection="column";
      card.querySelector("textarea").style.width="100%";
    }
  });
});

// Tuşları gizle/göster
document.getElementById("hideButtonsBtn").addEventListener("click",()=>{
  document.querySelectorAll("#buttons,#raporButtons").forEach(el=>{if(el) el.style.display="none"});
  showBtn.style.display="block";
});
showBtn.addEventListener("click",()=>{
  document.querySelectorAll("#buttons,#raporButtons").forEach(el=>{if(el) el.style.display="flex"});
  showBtn.style.display="none";
});
</script>

</body>
</html>